import{a as P}from"./chunk-UQZZIWYK.js";import{a as O}from"./chunk-5LBLQR7I.js";import"./chunk-BNCCPNSP.js";import"./chunk-P6OX5KW3.js";import{k as H}from"./chunk-NLB5HRRX.js";import{a as q}from"./chunk-5I5XZVIT.js";import"./chunk-5NPNKZ3O.js";import{i as $}from"./chunk-VE6ZJ4JM.js";import{B as L,Fb as S,Jb as f,Lb as l,O as I,R as E,Sa as u,Xb as m,aa as _,bc as F,cc as w,dc as a,fa as g,fb as V,fc as j,ga as C,kc as B,nc as N,o as k,pa as d,pb as z,qb as x,rb as b,sb as y,t as D,tb as v,ub as h,vb as p,wb as c,xb as s,yb as M,z as A}from"./chunk-VRT4WXDD.js";function J(r,t){if(r&1&&M(0,"app-course-card",3),r&2){let e=t.$implicit;p("course",e)("isPurchased",!0)}}function G(r,t){r&1&&(c(0,"div",4)(1,"span"),m(2,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0643\u0648\u0631\u0633\u0627\u062A \u062D\u0627\u0644\u064A\u0627."),s()())}function K(r,t){if(r&1){let e=S();c(0,"input",9),f("change",function(){let n=g(e).$index,o=l(3);return C(o.paginateHandler(n))}),s()}if(r&2){let e=t.$implicit,i=t.$index;l(3);let n=a(1);p("checked",n===i),z("aria-label",e)}}function Q(r,t){if(r&1){let e=S();c(0,"div",6)(1,"button",7),f("click",function(){g(e);let n=l(2),o=a(1);return C(o>0&&n.paginateHandler(o-1))}),m(2," \xAB "),s(),v(3,K,1,2,"input",8,y),c(5,"button",7),f("click",function(){g(e);let n=l(2),o=a(0),T=a(1);return C(T<o.length&&n.paginateHandler(T+1))}),m(6," \xBB "),s()()}if(r&2){l(2);let e=a(0),i=a(1);u(),p("disabled",i==0),u(2),h(e),u(2),p("disabled",i==e.length-1)}}function R(r,t){if(r&1&&x(0,Q,7,2,"div",6),r&2){l();let e=a(0);b(e.length?0:-1)}}function W(r,t){r&1&&M(0,"div",5)}var U=class r{courseService=_(P);toastService=_(q);userID=_(H).user()?.id;page=d(0);size=d(10);userCourses=d(Array(this.size()));paginationPages=d(null);ngOnInit(){this.courseService.getUserCourses(this.userID,1).pipe(E(({list:t,pagination:{total_pages:e}})=>L(()=>e>1,A(Array.from({length:e-1},(i,n)=>this.courseService.getUserCourses(this.userID,n+2))).pipe(D(i=>{let n=Array.from(new Map(t.concat(i.map(o=>o.list).flat()).map(o=>[o.id,o])).values());return n.reverse(),n})),k(t))),I(3)).subscribe({next:t=>{this.userCourses.set(t),this.paginationPages.set(Array.from({length:Math.ceil(t.length/this.size())},(e,i)=>++i))},error:t=>{this.toastService.addToast({id:Date.now(),type:"error",title:"\u062D\u062F\u062B \u062E\u0637\u0627 \u0645\u0627",message:t.message})}})}paginateHandler(t){this.page.set(t)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=V({type:r,selectors:[["app-my-courses"]],features:[j([P])],decls:12,vars:8,consts:[[1,"flex","flex-col","gap-10"],[1,"text-lg","lg:text-3xl","font-bold","text-body-5","pb-4","border-b","border-dashed","border-base-content","dark:border-custom-1"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-4"],[3,"course","isPurchased"],["role","alert",1,"col-span-4","alert","alert-info","justify-center","alert-soft"],[1,"skeleton","self-center","w-4/5","lg:w-1/4","h-6","lg:h-10"],[1,"join","self-center"],[1,"join-item","btn","btn-square",3,"click","disabled"],["type","radio",1,"join-item","btn","btn-square",3,"checked"],["type","radio",1,"join-item","btn","btn-square",3,"change","checked"]],template:function(e,i){if(e&1&&(F(0)(1),c(2,"section",0)(3,"h2",1),m(4," \u0643\u0648\u0631\u0633\u0627\u062A\u064A "),s(),c(5,"div",2),v(6,J,1,2,"app-course-card",3,y,!1,G,3,0,"div",4),B(9,"slice"),s(),x(10,R,1,1)(11,W,1,0,"div",5),s()),e&2){let n=w(i.paginationPages());u();let o=w(i.page());u(5),h(N(9,4,i.userCourses(),o*i.size(),o*i.size()+i.size())),u(4),b(n?10:11)}},dependencies:[O,$],encapsulation:2})};export{U as MyCourses};

@let course = courseSignal(); @let loading = courseLoading();
<div class="container">
  <div
    class="grid grid-cols-1 lg:grid-cols-4 gap-x-0 gap-y-6 lg:gap-y-0 lg:gap-x-8 border-b-base-content py-6 lg:py-10"
    [class.border-b]="!loading && !isMobile"
  >
    <div class="col-span-3 order-2 lg:order-1">
      <app-course-video
        [courseLoading]="loading"
        [title]="course.courseName_AR"
        [activeLesson]="course.topics | activeLesson"
        (nextVideo)="loadNextVideoHandler($event)"
      />
      <app-course-tabs
        [(activeTap)]="activeTap"
        (setActiveLesson)="setActiveLessonHandle($event)"
        [courseInstructorId]="course.userId"
        [courseLoading]="loading"
        [courseCustomReviews]="course.reviews"
        [courseTopics]="course.topics"
        [courseDescription]="course.courseDescription_AR"
        [courseDataVMs]="course.courseDataVMs"
        [isPaid]="course.isPaied"
        [courseId]="course.id"
      />
    </div>
    <div class="order-1 lg:order-2">
      <app-course-sidebar
        [keywords]="course.openKeys!"
        [courseLoading]="loading"
        [studentsCount]="course.studentsCount"
        [lessonCount]="course.lessonCount"
        [instructorBrief]="course.instructorBrief"
        [instructorName]="course.firstName + ' ' + course.familyName"
        [hourCount]="course.hourCount"
        [discountPrice]="course.discountPrice!"
        [originalPrice]="course.originalPrice!"
        [isPaid]="!!course.isPaied"
        [instructorId]="course.userId!"
        [courseId]="course.id"
        [coupon]="course.coupon"
        [courseName]="course.courseName_AR"
        [courseImg]="course.coverImageURL"
        [courseRedirectUrl]="course.redirect_url"
        [coursePaymentLabel]="course.paymentLabel"
        (addToCart)="addToCartHandler()"
        (applyCoupon)="applyCouponHandler($event)"
        (changePrice)="changeCoursePriceHandler($event)"
      />
    </div>
  </div>
  @if(isMobile){ @if(loading){
  <div class="mb-4">
    <div class="skeleton w-1/2 h-6 lg:h-7 mb-4"></div>
    <div class="skeleton w-full h-5 lg:h-6 mb-2"></div>
    <div class="skeleton w-full h-5 lg:h-6 mb-2"></div>
    <div class="skeleton w-full h-5 lg:h-6 mb-2"></div>
    <div class="skeleton w-full h-5 lg:h-6"></div>
  </div>
  <div class="mb-4">
    <div class="skeleton w-1/2 h-6 lg:h-7 mb-4"></div>
    <div class="flex flex-wrap gap-3">
      <div class="skeleton w-1/3 h-8 lg:h-10"></div>
      <div class="skeleton w-1/2 h-8 lg:h-10"></div>
      <div class="skeleton w-1/2 h-8 lg:h-10"></div>
      <div class="skeleton w-1/3 h-8 lg:h-10"></div>
    </div>
  </div>
  } @else {
  <div class="p-4 border border-dashed rounded-sm mb-6">
    <h4 class="lg:text-xl text-body-5 font-bold mb-4">
      {{ course.firstName + ' ' + course.familyName }}
    </h4>
    <p class="text-sm lg:text-base text-base-content">
      {{ course.instructorBrief }}
    </p>
  </div>
  <div class="p-4 border border-dashed rounded-sm">
    <h4 class="lg:text-xl text-body-5 font-bold mb-4">KeyWords</h4>
    <div class="flex flex-wrap gap-3">
      @for(keyword of course.openKeys;track $index){
      <div class="p-2 text-sm lg:text-base rounded-sm text-secondary bg-secondary-5">
        {{ keyword.name }}
      </div>
      }
    </div>
  </div>
  } }
  <app-course-related-courses [courseLoading]="loading" [courses]="relatedCourses()" />
</div>
@if(course.id && !course.isPaied){
<dialog id="courssat_checkout_modal" class="modal">
  <div class="modal-box max-w-3xl max-h-9/10">
    <app-payment-methods
      [courses]="courseArr()"
      [totalValue]="course.discountPrice"
      [totalOriginalValue]="course.originalPrice || course.discountPrice"
      customPaymentBtnClass="w-full"
    />
    <div class="modal-action justify-stretch sticky bottom-0">
      <form method="dialog" class="flex-1">
        <button class="btn btn-lg btn-ghost w-full">الغاء</button>
      </form>
    </div>
  </div>
</dialog>
}

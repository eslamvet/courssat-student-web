@let course = courseSignal(); @let loading = courseLoading();
<div class="container">
  <div class="grid grid-cols-4 gap-8 border-b-base-content py-10" [class.border-b]="!loading">
    <div class="col-span-3">
      <app-course-video
        [courseLoading]="loading"
        [title]="course.courseName_AR"
        [activeLesson]="course.topics | activeLesson"
        (nextVideo)="loadNextVideoHandler($event)"
      />
      <app-course-tabs
        [(activeTap)]="activeTap"
        (setActiveLesson)="setActiveLessonHandle($event)"
        [courseInstructorId]="course.userId"
        [courseLoading]="loading"
        [courseCustomReviews]="course.reviews"
        [courseTopics]="course.topics"
        [courseDescription]="course.courseDescription_AR"
        [courseDataVMs]="course.courseDataVMs"
        [isPaid]="course.isPaied"
        [courseId]="course.id"
      />
    </div>
    <div>
      <app-course-sidebar
        [keywords]="course.openKeys!"
        [courseLoading]="loading"
        [studentsCount]="course.studentsCount"
        [lessonCount]="course.lessonCount"
        [instructorBrief]="course.instructorBrief"
        [instructorName]="course.firstName + ' ' + course.familyName"
        [hourCount]="course.hourCount"
        [discountPrice]="course.discountPrice!"
        [originalPrice]="course.originalPrice!"
        [isPaid]="!!course.isPaied"
        [instructorId]="course.userId!"
        [courseId]="course.id"
        [coupon]="course.coupon"
        [courseName]="course.courseName_AR"
        [courseImg]="course.coverImageURL"
        [courseRedirectUrl]="course.redirect_url"
        [coursePaymentLabel]="course.paymentLabel"
        (addToCart)="addToCartHandler()"
        (applyCoupon)="applyCouponHandler($event)"
        (changePrice)="changeCoursePriceHandler($event)"
      />
    </div>
  </div>
  <app-course-related-courses [courseLoading]="loading" [courses]="relatedCourses()" />
</div>
@if(!course.isPaied){
<dialog id="courssat_checkout_modal" class="modal">
  <div class="modal-box max-w-3xl max-h-9/10">
    <app-payment-methods
      [courses]="courseArr()"
      [totalValue]="course.discountPrice"
      [totalOriginalValue]="course.originalPrice || course.discountPrice"
      customPaymentBtnClass="w-full"
    />
    <div class="modal-action justify-stretch sticky bottom-0">
      <form method="dialog" class="flex-1">
        <button class="btn btn-lg btn-ghost w-full">الغاء</button>
      </form>
    </div>
  </div>
</dialog>
}
